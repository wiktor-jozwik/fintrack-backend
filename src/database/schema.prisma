generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native", "linux-musl"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                Int                @id @default(autoincrement())
  createdAt         DateTime           @default(now()) @map("created_at")
  updatedAt         DateTime           @updatedAt @map("updated_at")
  firstName         String?            @map("first_name")
  lastName          String?            @map("last_name")
  phoneNumber       String?            @map("phone_number")
  email             String             @unique
  password          String
  categories        Category[]
  usersToCurrencies UserToCurrencies[]

  @@map("users")
}

model Category {
  id         Int          @id @default(autoincrement())
  name       String
  type       CategoryType
  user       User         @relation(fields: [userId], references: [id])
  userId     Int          @map("user_id")
  operations Operation[]

  @@unique(fields: [name, userId], name: "user_category")
  @@map("categories")
}

model Operation {
  id          Int      @id @default(autoincrement())
  name        String
  moneyAmount Decimal  @map("money_amount")
  date        DateTime @db.Date
  category    Category @relation(fields: [categoryId], references: [id])
  categoryId  Int      @map("category_id")
  currency    Currency @relation(fields: [currencyId], references: [id])
  currencyId  Int      @map("currency_id")

  @@map("operations")
}

model Currency {
  id                Int                @id @default(autoincrement())
  name              String @unique
  symbol            String @unique
  operations        Operation[]
  usersToCurrencies UserToCurrencies[]

  @@map("currencies")
}

model UserToCurrencies {
  createdAt  DateTime @default(now()) @map("created_at")
  currency   Currency @relation(fields: [currencyId], references: [id])
  currencyId Int      @map("currency_id")
  user       User     @relation(fields: [userId], references: [id])
  userId     Int      @map("user_id")

  @@id([currencyId, userId])
  @@map("user_to_currencies")
}

enum CategoryType {
  INCOME
  OUTCOME
}
